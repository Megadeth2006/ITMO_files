# 11. Формула Ньютона—Лейбница

> В этом разделе мы рассмотрим формулу Ньютона—Лейбница, выражающую интеграл Римана через значения первообразной подынтегральной функции. Эту формулу часто называют **основной формулой (теоремой) интегрального исчисления**.
> 
Ниже приведена основная формула интегрального исчисления.
## Формула Ньютона—Лейбница для непрерывных функций

> В виду важности последних, отметим отдельно теорему Ньютона—Лейбница для интегралов от непрерывных функций.
> 

Итак, сразу сформулируем теорему.


 **[ Теорема ] (формула Ньютона—Лейбница для интегралов от непрерывных функций)**

Пусть $f \in C[a, b]$ и $F$ — ее первообразная. Тогда

$$
\int\limits_a^b f \ dx = F(b) - F(a).
$$

- **Доказательство.**
    
    Согласно [следствию](https://www.notion.so/10-1cf50c8be49481889308ed8c06b8bee4?pvs=21) о существовании первообразной непрерывной функций, любая первообразная непрерывной функции имеет вид
    
    $$
    F(x) = \int\limits_a^x f \ dt + C.
    $$
    
    Подставим сначала $x = a$, получим
    
    $$
    F(a) = \int\limits_a^a f \ dx + C \ \Rightarrow \ C = F(a) \ \Rightarrow \ F(x) = \int\limits_a^x f \ dt + F(a).
    $$
    
    Теперь, подставив $x= b$, придем к требуемому соотношению:
    
    $$
    F(b) = \int\limits_a^b f(x)dx + F(a) \ \Rightarrow \ \int\limits_a^b f(x)dx = F(b) - F(a).
    $$
Отметим несколько важных замечаний.
 **[ NB ]**

Отметим, что формула Ньютона—Лейбница справедлива для любой первообразной подынтегральной функции, и что значение интеграла не зависит от выбора этой первообразной. Действительно, если выбрана первообразная $F(x) + C$, то

$$
F(b) - F(a) = F(b) + C - F(a) - C.
$$
 **[ NB ]**

Часто вводят следующее обозначение, называемое двойной подстановкой:

$$
F \ \Big|_a^b := F(b) - F(a).
$$

Используя это соотношение, запись формулы Ньютона—Лейбница часто можно встретить в следующем виде:

$$
\int\limits_a^b f \ dx = F \ \Big|_a^b.
$$
Приведем пример использования данной теоремы и вычислим интеграл от [функции](https://www.notion.so/4-1cf50c8be494816f9b1de9664623016e?pvs=21), с которой мы начали наше повествование.
 **[ Пример ]**

Вычислить интеграл

$$
\int\limits_0^1 x^2 \ dx.
$$

Используя формулу Ньютона—Лейбница, получим

$$
\int\limits_0^1 x^2 \ dx =  \frac{x^3}{3} \Big|_0^1 = \frac{1}{3}.
$$
Формула Ньютона—Лейбница справедлива не только для непрерывных подынтегральных функций.

## Формула Ньютона—Лейбница для функций, имеющих первообразную

Результат этого пункта обобщает полученное в предыдущем пункте. Сформулируем его.
 **[ Теорема ] (усиленная формула Ньютона--Лейбница)**

Пусть $f \in R[a, b]$ и $F$ — некоторая первообразная $f$ на $[a, b]$, тогда

$$
\int\limits_a^b f \ dx  =  F(b) - F(a).
$$

- **Доказательство.**
    
    Введем следующее разбиение отрезка $[a, b]$:
    
    $$
    x_k = a + \frac{k(b-a)}{n}, \quad k \in \{0, 1, ..., n\}.
    $$
    
    Пусть $F$ — какая-то первообразная $f$ на $[a, b]$. Тогда
    
    $$
    F(b) - F(a) = F(x_n) - F(x_0) = \sum\limits_{k = 1}^n \left( F(x_k) - F(x_{k-1}) \right).
    $$
    
    Согласно теореме Лагранжа, существует $\xi_k^n \in (x_{k - 1}, x_k)$, что
    
    $$
    F(x_k) - F(x_{k-1}) = f(\xi_k^n)(x_k - x_{k - 1}),
    $$
    
    а тогда
    
    $$
    F(b) - F(a) = \sum\limits_{k = 1}^n f(\xi_k^n)\Delta x_k,
    $$
    
    и мы получаем интегральную сумму для функции $f$ по отрезку $[a, b]$ с оснащенным разбиением $(\tau, \xi)$. 
    
    Так как $f \in R[a, b]$ и так как при $n \to +\infty$ выполняется $\lambda(\tau) \to 0$, то
    
    $$
    \lim\limits_{n \to + \infty }\sum\limits_{k = 1}^n f(\xi_k^n)\Delta x_k = \int\limits_a^b f \ dx.
    $$
    
    С другой стороны,
    
    $$
    F(b) - F(a) = \lim\limits_{n \to + \infty} \sum\limits_{k = 1}^n f(\xi_k^n)\Delta x_k,
    $$
    
    а значит
    
    $$
    \int\limits_a^b f \ dx = F(b) - F(a).
    $$
    


Отметим замечание, аналогичное сделанному ранее.


 **[ NB ]**

Доказанная формула Ньютона—Лейбница справедлива для любой первообразной интегрируемой функции, и значение интеграла [не зависит](https://www.notion.so/11-1cf50c8be494814ca849e1b1b6e05516?pvs=21) от выбора этой первообразной.
## Обобщенные первообразные и формула Ньютона—Лейбница
Часто бывает удобным расширить понятие первообразной, [введенное ранее](https://www.notion.so/1-1cf50c8be494816ab04cf52752375534?pvs=21).
 **[ Определение ] (понятие обобщенной первообразной)**

Обобщенной первообразной функции $f$ на промежутке $\langle a, b \rangle$ называется функция $F\in C(\langle a, b \rangle)$ такая, что равенство

$$
F'(x) = f(x)
$$

выполнено всюду на $\langle a, b \rangle$, кроме, быть может, конечного числа точек.
Приведем пример.
 **[ Пример ]**

Функция $F(x) = |x|$ является обобщенной первообразной для функции $f(x) = \operatorname{sign}(x)$ на $\mathbb R.$
Оказывается, формула Ньютона-Лейбница справедлива и для обобщенных первообразных.
 **[ Теорема ] (формула Ньютона—Лейбница для обобщенных первообразных)**

Пусть $f \in R[a, b]$ и $F$ — обобщенная первообразная функции $f$ на $[a, b]$. Тогда

$$
\int\limits_a^b f \ dx = F(b) - F(a).
$$

- **Доказательство.**
    
    Пусть $\alpha_1, \alpha_2, ..., \alpha_{k-1}$ — точки внутри $(a, b)$, в которых нарушено условие $F'(x) = f(x)$. Добавим к ним $\alpha_0 = a$, $\alpha_k = b$. Так как интеграл — [непрерывная](https://www.notion.so/10-1cf50c8be49481889308ed8c06b8bee4?pvs=21) функция по обоим пределам, то
    
    $$
    \int\limits_{\alpha_{p - 1}}^{\alpha_p} f(x) dx = \lim\limits_{\varepsilon \to 0 + } \int\limits_{\alpha_{p - 1} + \varepsilon}^{\alpha_p - \varepsilon} f(x) dx = \lim\limits_{\varepsilon \to 0 +} \left(F(\alpha_p - \varepsilon) - F(\alpha_{p-1} + \varepsilon) \right) =
    $$
    
    $$
    = F(\alpha_p) - F(\alpha_{p - 1}),
    $$
    
    где последнее равенство справедливо ввиду того, что $F$ — непрерывная функция. Тогда
    
    $$
    \int\limits_a^b f(x)dx = \sum\limits_{p = 1}^k \int\limits_{\alpha_{p - 1}}^{\alpha_p} f(x) dx = \sum\limits_{p = 1}^k \left(F(\alpha_p) - F(\alpha_{p-1}) \right) =
    $$
    
    $$
    = F(\alpha_k) - F(\alpha_0) = F(b) - F(a).
    $$

Отметим и следующее любопытное замечание, которое выделим в отдельный пункт.
## О связи интегрируемости и наличии первообразной

> Несмотря на то, что формула Ньютона—Лейбница связывает два весьма разных понятия: понятие первообразной и понятие интеграла Римана, прямой связи между интегрируемостью и наличием первообразной у интегрируемой функции нет.
> 

Опишем сказанное строго в следующем замечании. 


 **[ NB ] (о связи интегрируемости и наличии первообразной)**

Не каждая интегрируемая функция имеет первообразную, и не каждая функция, имеющая первообразную, интегрируема. 

Функция 

$$
f(x) = \begin{cases}
x^2 \sin \frac{1}{x^2}, & x \neq 0 \\
0, & x = 0	
\end{cases}
$$

дифференцируема, а значит ее производная имеет первообразную, но $f' \notin R[-1, 1]$ (в силу неограниченности).

С другой стороны, функция $f(x) = \operatorname{sign} x \in R[-1, 1]$, но не имеет первообразной на этом промежутке. Она имеет обобщенную первообразную.

Важный вывод, который можно сделать из сказанного, следующий:  интегрируемость и наличие первообразной — напрямую несвязанные между собой вещи.
> Отметим, что примеры выше можно усилить. Существует дифференцируемая функция $f$, производная которой $f'$ не интегрируема, хотя ограничена. Наоборот, существует интегрируемая функция $f$, которая не имеет даже обобщенной первообразной.
>