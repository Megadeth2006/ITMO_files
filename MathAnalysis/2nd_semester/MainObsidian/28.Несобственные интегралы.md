# 17. Понятие несобственного интеграла и его свойства

## Понятие несобственного интеграла

> В предыдущих разделах мы подробно обсудили интеграл Римана: и с точки зрения формального построения, и с точки зрения различных приложений. Однако оказывается, что как потребности самой математики, так и приложений, требуют расширения введенного понятия в двух направлениях:
> 
> - во-первых, хочется отказаться от необходимого условия интегрируемости — в случаях, когда это возможно, научиться определять интеграл от неограниченной функции, пусть и значением $+\infty$;
> - во-вторых, хочется научиться распространять интеграл Римана с отрезка на неограниченный промежуток.
> 
> Разрешением этих вопросов мы и займемся в этом пункте.
> 

Начнем с того, что введем то основное определение, от которого и будем отталкиваться при построении нового объекта.


**[ Определение ] (понятие локальной интегрируемости)**

Говорят, что функция $f$ локально интегрируема на множестве $E$, и пишут $f \in R_{loc}(E)$, если $f \in R[a, b]$ для любого $[a, b] \subset E$.



> Итак, локально интегрируемая функция интегрируема на любом отрезке, содержащемся в $E$.
> 

Теперь мы можем ввести основной объект, исследуемый далее.


**[ Определение ] (понятие несобственного интеграла)**

Пусть $f \in R_{loc}[a, b)$, $-\infty < a < b \leq + \infty$. Тогда символ

$$
\int\limits_a^b f \ dx
$$

называется несобственным интегралом от функции $f$ по множеству $[a, b)$.



> Итак, пока что несобственный интеграл для нас — это просто некоторый символ. Попробуем придать этому символу разумное числовое значение. Сделать это можно, основываясь на следующих рассуждениях.
> 
> 
> Посмотрим на то, что требуется в определении, — на локальную интегрируемость функции $f$. То, что функция $f$ оказывается локально интегрируемой на $[a, b)$, позволяет нам рассматривать уже изученные (стандартные) интегралы Римана по множествам $[a, \omega]$, $\omega \in (a, b)$.Дальше же можно совершить стандартный для анализа предельный переход — для определения значения несобственного интеграла по $[a, b)$ можно устремить $\omega \to b-0$ и посмотреть, получится ли что-то разумное.
> 

Сформулируем теперь формальное определение.


**[ Определение ] (понятие значения несобственного интеграла)**

Пусть $f \in R_{loc}[a, b)$, $-\infty < a < b \leq + \infty$ и $\omega \in [a, b)$. Предел

$$
\lim\limits_{\omega \to b - 0} \int\limits_a^\omega f \ dx,
$$

если он существует в $\overline{\mathbb{R}}$, называется значением несобственного интеграла от функции $f$ по множеству $[a, b)$.



Введем, аналогично тому, что было сделано в теории предела последовательности, понятие сходящегося несобственного интеграла.


**[ Определение ] (понятие сходящегося интеграла)**

Пусть $f \in R_{loc}[a, b)$, $-\infty < a < b \leq + \infty$ и $\omega \in [a, b)$. Если предел

$$
\lim\limits_{\omega \to b-0} \int\limits_a^\omega f \ dx
$$

существует в $\mathbb R$, то несобственный интеграл называется сходящимся. Иначе — расходящимся.



Отметим напрашивающееся замечание.


 **[ NB ]**

Понятно, что все определения, данные выше, и теоремы, доказанные ниже, симметричным образом переносятся на случай  $f \in R_{loc}(a, b]$, $-\infty \leq a < b < + \infty.$ Мы оставляем формулировки и доказательства читателю в качестве упражнения.



Приведем некоторые примеры.


 **[ Пример ]**

Исследуем на сходимость несобственный интеграл

$$
\int\limits_1^{+\infty} \frac{dx}{x^\alpha}.
$$

Согласно определению,

$$
\int\limits_1^{+\infty} \frac{dx}{x^\alpha} = \lim\limits_{\omega \to + \infty} \int\limits_1^\omega \frac{dx}{x^\alpha} = \lim\limits_{\omega \to + \infty} \left. \left( \begin{cases} \ln x , & \alpha = 1 \\ \frac{1}{x^{\alpha - 1}(1 - \alpha)}, & \alpha \neq 1 \end{cases} \right) \right|_1^\omega = \begin{cases} +\infty,  & \alpha \leq 1 \\ \frac{1}{\alpha - 1}, & \alpha >1 \end{cases}.
$$

Итак, несобственный интеграл сходится при $\alpha > 1$ и расходится при $\alpha \leq 1$.



Рассмотрим теперь другой «по качеству» пример.


 **[ Пример ]**

Исследуем на сходимость несобственный интеграл

$$
\int\limits_0^{1} \frac{dx}{x^\alpha}.
$$

Согласно определению,

$$
\int\limits_0^{1} \frac{dx}{x^\alpha} = \lim\limits_{\omega \to 0+0} \int\limits_\omega^1 \frac{dx}{x^\alpha} = \lim\limits_{\omega \to 0+0} \left. \left( \begin{cases} \ln x , & \alpha = 1 \\ \frac{1}{x^{\alpha - 1}(1 - \alpha)}, & \alpha \neq 1 \end{cases} \right) \right|_\omega^1 = \begin{cases} +\infty,  & \alpha \geq 1 \\ \frac{1}{1 - \alpha}, & \alpha < 1 \end{cases}.
$$

Итак, несобственный интеграл сходится при $\alpha < 1$ и расходится при $\alpha \geq 1$.



> Отметим, что в примерах выше мы рассмотрели два анонсированных в начале этого раздела и качественно отличающихся друг от друга случая: случай интеграла по неограниченному промежутку и случай интеграла от неограниченной функции по промежутку конечной длины.
> 


**[ Определение ] (понятия интегралов 1 и 2 родов)**

Несобственный интеграл по неограниченному промежутку часто называется несобственным интегралом первого рода.

Несобственный интеграл от неограниченной функции по промежутку конечной длины часто называется несобственным интегралом второго рода.



Отметим также, что введенное понятие несобственного интеграла и правда расширяет ранее введенное понятие интеграла Римана.


 **[ Лемма ] (о совпадении собственного и несобственного интегралов)**

Пусть $f \in R[a, b]$. Тогда

$$
\lim\limits_{\omega \to b - 0} \int\limits_a^\omega f \ dx = \int\limits_a^b f \ dx,
$$

где справа стоит интеграл Римана от функции $f$ по отрезку $[a, b]$.

- **Доказательство.**
    
    Доказательство немедленно следует из свойства [непрерывности интеграла с переменным верхним пределом](https://www.notion.so/10-1cf50c8be49481889308ed8c06b8bee4?pvs=21).
    


> Итак, только что приведенная лемма утверждает, что в случае, когда функция интегрируема на отрезке $[a, b]$, понятия несобственного интеграла по $[a, b)$ и интеграла Римана по $[a, b]$ совпадают.
> 
> 
> Даже больше, пары условий: $f \in R_{loc}[a, b)$ и $f$ ограничена на $[a, b)$ [достаточно](https://www.notion.so/8-1cf50c8be4948166acebf07d438bc446?pvs=21) для того, чтобы $f$ была интегрируемой по $[a, b]$ (или чтобы $f$ можно было сделать интегрируемой по $[a, b)$). 
> 
> В итоге, новая ситуация возникает лишь в случае **неограниченности** $f$ на $[a, b)$.
> 
> Для случая неограниченного промежутка подобной аналогии, конечно же, не существует.
> 

Перейдем к изучению свойств введенного объекта.

---

## Свойства несобственного интеграла

> Свойства несобственного интеграла во многом аналогичны уже изученным свойствам интеграла Римана. Мы не будем перечислять все эти свойства, а ограничимся лишь теми, что потребуются нам в дальнейшем при изложении теории. Впрочем, как вы увидите, практически все теоремы, верные для интеграла Римана, переносятся на несобственный интеграл с естественными дополнениями и одинаковыми доказательствами, поэтому читатель может получить свое собственное удовольствие, подумав, какие теоремы-таки переносятся, а какие — нет, и «доработав» неозвученное. Итак, пойдем «прямо по пунктам».
> 

### Линейность несобственного интеграла

Начнем со свойства линейности.


 **[ Теорема ] (о линейности несобственного интеграла)**

Пусть $f \in R_{loc}[a, b)$. Если сходятся интегралы

$$
\int\limits_a^b f \ dx \quad \text{и} \quad \int\limits_a^b g \ dx,
$$

то

$$
\int\limits_a^b (\alpha f + \beta g) \ dx = \alpha \int\limits_a^b f \ dx + \beta \int\limits_a^b g \ dx.
$$

- **Доказательство.**
    
    Для доказательства достаточно перейти к пределу при $\omega \to b-0$ в равенстве, [справедливом](https://www.notion.so/9-1cf50c8be49481eaac22d2c775902e19?pvs=21) для интеграла Римана:
    
    $$
    \int\limits_a^\omega (\alpha f + \beta g) \ dx = \alpha \int\limits_a^\omega f \ dx + \beta \int\limits_a^\omega g \  dx.
    $$
    


Отметим важное следствие из доказанной теоремы.


**[ Следствие ] (о расходимости суммы)**

Пусть $f, g \in R_{loc}[a, b)$, причем интеграл от $f$ по $[a, b)$ сходится, а интеграл от $g$ по $[a, b)$ расходится. Тогда интеграл от $f + g$ по $[a, b)$ расходится.

- **Доказательство.**
    
    Действительно, если бы сходился интеграл от $f + g$ по $[a, b)$, то по предыдущей [теореме](https://www.notion.so/17-1cf50c8be49481038115cc262b6e5f78?pvs=21) сходился бы интеграл от
    
    $$
    g = (f + g) - f \ \text{ по } \ [a, b),
    $$
    
    что противоречит условию.
    


Отметим следующее замечание, касаемое «суммы расходящихся интегралов»


 **[ NB ]**

Пусть $f, g \in R_{loc}[a, b)$, причем интегралы от $f$ и $g$ по $[a, b)$ расходятся. Тогда интеграл от $f + g$ по $[a, b)$ может как сходиться, так и расходиться. 

Пусть, скажем,

$$
f = g = \frac{1}{x}, \quad x \in [1, +\infty).
$$

В этом случае, очевидно, интеграл от $f + g$ по $[1, +\infty)$ расходится, а интеграл от $f - g$ — сходится.



Теперь обсудим свойство аддитивности несобственного интеграла по промежутку.

---

### Аддитивность несобственного интеграла

Ровно как и свойство линейности, на несобственные интегралы переносится и свойство аддитивности по промежутку.


 **[ Теорема ] (об аддитивности по промежутку)**

Пусть $f \in R_{loc}[a, b)$. Тогда для любого $c \in (a, b)$ справедливо равенство

$$
\int\limits_a^b f \ dx = \int\limits_a^c f \ dx + \int\limits_c^b f \ dx,
$$

причем интегралы

$$
\int\limits_a^b f \ dx \quad \text{и} \quad \int\limits_c^b f \  dx
$$

сходятся или нет одновременно.

- **Доказательство.**
    
    Для доказательства достаточно перейти к пределу при $\omega \to b-0$ в равенстве, [справедливом для интеграла Римана](https://www.notion.so/9-1cf50c8be49481eaac22d2c775902e19?pvs=21):
    
    $$
    \int\limits_a^\omega f \ dx = \int\limits_a^c f \ dx + \int\limits_c^\omega f \ dx.
    $$
    


Данная теорема позволяет свести вопрос сходимости интеграла к вопросу стремления к нулю остатка или, как еще говорят, «хвоста» интеграла.


**[ Определение ] (понятие остатка интеграла)**

Пусть $f \in R_{loc}[a, b)$, $c \in (a, b).$ Тогда

$$
\int\limits_c^b f \ dx
$$

называется остатком несобственного интеграла от $f$ по $[a, b)$.




 **[ Лемма ] (сходимость интеграла в терминах остатков)**

Пусть $f \in R_{loc}[a, b)$, $c \in (a, b).$ Тогда сходимость несобственного интеграла от $f$ по $[a, b)$ равносильна тому, что

$$
\lim\limits_{c \to b - 0} \int\limits_c^b f \ dx = 0.
$$

**Доказательство:**

- **Необходимость.**
    
    Пусть несобственный интеграл от $f$ по $[a, b)$ сходится. Тогда, по [теореме об аддитивности по промежутку](https://www.notion.so/17-1cf50c8be49481038115cc262b6e5f78?pvs=21),
    
    $$
    \int\limits_a^b f \ dx = \int\limits_a^c f \ dx + \int\limits_c^b f \ dx.
    $$
    
    Пусть теперь $c \to b-  0$, тогда
    
    $$
    \lim\limits_{c \to b - 0} \int\limits_a^c f \ dx = \int\limits_a^b f \ dx,
    $$
    
    откуда и следует требуемое.
    
- **Достаточность.**
    
    Пусть теперь остаток интеграла стремится к нулю. Значит, при некотором $c \in (a, b)$
    
    $$
    \int\limits_c^b f \ dx \in \mathbb R.
    $$
    
    Но тогда, при $\omega > c$ [выполнено](https://www.notion.so/9-1cf50c8be49481eaac22d2c775902e19?pvs=21)
    
    $$
    \int\limits_a^\omega f \ dx = \int\limits_a^c f \ dx + \int\limits_c^\omega f \ dx
    $$
    
    и при $\omega \to b-0$ приходим к требуемому.
    


---

### Монотонность несобственного интеграла

Теперь обсудим свойство монотонности несобственного интеграла.


 **[ Теорема ] (о монотонности несобственного интеграла)**

Пусть $f,g \in R_{loc}[a, b)$, причем

$$
\int\limits_a^b f \ dx \in \overline{\mathbb R} \quad \text{и} \quad \int\limits_a^b g \  dx \in \overline{\mathbb R}.
$$

Если $f \leq g$ на $[a, b)$, то

$$
\int\limits_a^b f \ dx \leq \int\limits_a^b g \ dx.
$$

- **Доказательство.**
    
    Для доказательства достаточно перейти к пределу при $\omega \to b-0$ в неравенстве, [справедливом для интеграла Римана](https://www.notion.so/9-1cf50c8be49481eaac22d2c775902e19?pvs=21):
    
    $$
    \int\limits_a^\omega f \ dx \leq \int\limits_a^\omega g \ dx.
    $$
    


---

## Замена переменной и интегрирование по частям в несобственном интеграле

> В этом разделе мы обсудим формулы замены переменной и интегрирования по частям, но для несобственного интеграла. Естественно, сами по себе они происходят из уже известных формул, доказанных для интеграла Римана.
> 

### Формула интегрирования по частям

Начнем с формулы интегрирования по частям. 


 **[ Теорема ] (формула интегрирования по частям)**

Пусть $u, v$ дифференцируемы на $[a, b)$ и $u', v' \in R_{loc}[a, b)$. Тогда

$$
\int\limits_a^b uv' \ dx =  uv \big|_a^b - \int\limits_a^b vu' \ dx, \quad uv \big|_a^b := \lim\limits_{\omega \to b-0} u(\omega)v(\omega) - u(a)v(a),
$$

или

$$
\int\limits_a^b u \ dv =  uv \big|_a^b - \int\limits_a^b v \ du,
$$

причем равенство справедливо тогда и только тогда, когда существует (в $\mathbb R$) хотя бы два предела из трех.

- **Доказательство.**
    
    Для доказательства достаточно перейти к пределу при $\omega \to b-0$ в [верном](https://www.notion.so/12-1cf50c8be494818c891afbb8cb3682d1?pvs=21) для интеграле Римана равенстве:
    
    $$
    \int\limits_a^w uv' \ dx =  uv \big|_a^w - \int\limits_a^w vu' \ dx.
    $$
    


---

### Формула замены переменной

> Перейдем теперь к важной для практике формуле замены переменной. Оказывается, с ней не все так гладко: в результате замены переменной из несобственного интеграла можно получать интеграл Римана, и наоборот. Давайте сначала разберемся с самой теоремой, а потом посмотрим примеры.
> 

Итак, сначала сформулируем само утверждение.


 **[ Теорема ] (первый вариант формулы замены переменной)**

Пусть $f \in C[A, B)$, $x = \varphi(t): [\alpha, \beta) \to [A, B)$, $\varphi$ дифференцируема и $\varphi' \in R_{loc}[\alpha, \beta)$. Пусть, кроме того, существует $\varphi(\beta-0) \in \mathbb {\overline R}$. Тогда

$$
\int\limits_\alpha^\beta (f \circ \varphi)\varphi' \ dt = \int\limits_{\varphi(\alpha)}^{\varphi(\beta-0)} f \ dx,
$$

причем если существует один интеграл (в $\overline{\mathbb{R}}$), то существует и другой.

- **Доказательство.**
    
    Пусть сначала существует интеграл в правой части, то есть интеграл 
    
    $$
    I:=\int\limits_{\varphi(\alpha)}^{\varphi(\beta - 0)} f \ dx, \quad I \in \overline{\mathbb R}.
    $$
    
    Пусть $\omega \in [\alpha, \beta)$. Тогда, используя [формулу замены переменной для интеграла Римана](https://www.notion.so/12-1cf50c8be494818c891afbb8cb3682d1?pvs=21), приходим к равенству
    
    $$
    \int\limits_{\alpha}^\omega (f \circ \varphi)\varphi' \ dt  = \int\limits_{\varphi(a)}^{\varphi(\omega)}f(x) dx,
    $$
    
    откуда
    
    $$
    \lim\limits_{\omega \to \beta - 0}\int\limits_{\alpha}^\omega (f \circ \varphi)\varphi' \ dt  = \lim\limits_{\omega \to \beta-0}\int\limits_{\varphi(a)}^{\varphi(\omega)}f(x) dx = I.
    $$
    
    Пусть теперь существует 
    
    $$
    I:=\int\limits_\alpha^\beta (f \circ \varphi)\varphi' \ dt, \quad I \in \overline{\mathbb R}.
    $$
    
    Докажем существование правого интеграла.
    
    Пусть, для начала, $\varphi(\beta-0) \in [A, B)$. Тогда интеграл в правой части [равенства](https://www.notion.so/17-1cf50c8be49481038115cc262b6e5f78?pvs=21) существует как собственный. В этом случае справедливость интересующего нас равенства вытекает из только что доказанного.
    
    Пусть теперь $\varphi(\beta- 0 ) = B$ и $x_n \in [A, B)$ — последовательность, что $x_n \xrightarrow[n \to + \infty]{} B$. Не умаляя общности можно читать, что $x_n \in [\varphi(\alpha), B)$. Тогда, по теореме Больцано-Коши, найдутся точки $\gamma_n \in [\alpha, \beta)$ такие, что $\varphi(\gamma_n) = x_n$.
    
    Покажем, что $\gamma_n \to \beta-0$. Пусть $\beta' \in [\alpha, \beta)$. Так как 
    
    $$
    \max\limits_{[\alpha, \beta']}\varphi < B, \quad \varphi(\gamma_n) \xrightarrow[n \to + \infty]{} B,
    $$
    
    то, начиная с некоторого момента, $\gamma_n \in (\beta', \beta)$. Значит, $\gamma_n \to \beta-0$ и
    
    $$
    \int\limits_{\varphi(\alpha)}^{x_n} f \ dx = \int\limits_\alpha^{\gamma_n} (f \circ \varphi)\varphi' \ dt \xrightarrow[n \to + \infty]{}I.
    $$
    


Приведем интересный пример.


 **[ Пример ]**

Вычислить (собственный) интеграл

$$
\int\limits_0^{\pi} \frac{dx}{2+ \cos x}.
$$

Воспользуемся подстановкой $t = \tg \frac{x}{2}$. Функция $\varphi(t) = 2\arctg t$ — это функция, отображающая $[0, +\infty)$ на $[0, \pi)$. Так как

$$
dx = \frac{2 \ dt}{1 + t^2}, \quad \varphi(0) = 0, \quad \varphi(+\infty) = \pi, 
$$

то

$$
\int\limits_0^\pi \frac{dx}{2 + \cos x} = \int\limits_0^{+\infty} \frac{1}{2 + \frac{1 - t^2}{1 + t^2}} \cdot \frac{2dt}{1 + t^2} = 2\int\limits_0^{+\infty} \frac{dt}{3 + t^2} = \frac{2}{\sqrt{3}} \left.\arctg \frac{t}{\sqrt{3}}\right|_0^{+\infty} = \frac{\pi}{\sqrt{3}}.
$$



> Как видно в приведенном примере, после замены переменной собственный интеграл (интеграл Римана) был сведен к несобственному интегралу. В принципе, в доказанном [равенстве](https://www.notion.so/17-1cf50c8be49481038115cc262b6e5f78?pvs=21) возможны все варианты: два несобственных интеграла, два собственных интеграла, один собственный, а один — несобственный интегралы.
> 

Отметим и второй вариант формулы замены переменной.


 **[ Теорема ] (второй вариант формулы замены переменной)**

Пусть $\varphi$ дифференцируема и строго монотонна на $[\alpha, \beta)$, $\varphi' \in R_{loc}[\alpha, \beta)$, $f \in R_{loc}[\varphi(\alpha),\varphi(\beta-0))$. Тогда

$$
\int\limits_\alpha^\beta (f \circ \varphi)\varphi' \ dt = \int\limits_{\varphi(\alpha)}^{\varphi(\beta-0)} f \ dx,
$$

причем если существует один интеграл (в $\overline{\mathbb{R}}$), то существует и другой.

- **Доказательство.**
    
    Доказательство проведите самостоятельно с использованием [аналогичной](https://www.notion.so/12-1cf50c8be494818c891afbb8cb3682d1?pvs=21) теоремы для интеграла Римана.
    


---

## О сведении интеграла второго рода к интегралу первого рода

> В этом пункте мы приведем одно удобное для дальнейшего замечание. Оказывается, интеграл второго рода (от неограниченной функции) может быть приведен к интегралу первого рода (по бесконечному промежутку). Это позволит нам рассматривать в качестве примеров лишь интегралы по бесконечному промежутку.
> 


 **[ NB ]**

Доказанные теоремы о замене переменной позволяют свести интегралы по конечному промежутку $[a, b)$ к интегралам по бесконечному промежутку. Действительно, отображение

$$
x = b - \frac{1}{t}: \left[\frac{1}{b - a}, +\infty \right) \to [a, b)
$$

приводит интеграл второго рода к интегралу первого рода:

$$
\int\limits_a^b f \ dx = \int\limits_{\frac{1}{b-a}}^{+\infty} f\left(b - \frac{1}{t} \right) \ \frac{dt}{t^2}.
$$

Значит, не нарушая общности, в дальнейшем можно исследовать интегралы лишь по бесконечному промежутку. Мы будем пользоваться этим соображением при рассмотрении примеров.

