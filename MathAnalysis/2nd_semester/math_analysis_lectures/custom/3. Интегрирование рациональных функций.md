
**Определение:** Многочленом (полиномом) $P_n(x)$ степени $n$ ($n \ge 0$, $n \in \mathbb{Z}$) называется функция вида:
$P_n(x) = a_0 + a_1 x + a_2 x^2 + \dots + a_n x^n$, где $a_i \in \mathbb{R}$, $a_n \neq 0$.

**Определение:** Рациональной функцией (рациональной дробью) называется функция вида $\frac{P_n(x)}{Q_m(x)}$, где $P_n(x)$ и $Q_m(x)$ - многочлены.

**Определение:** Рациональная функция $\frac{P_n(x)}{Q_m(x)}$ называется **правильной**, если степень числителя меньше степени знаменателя: $\deg(P_n(x)) < \deg(Q_m(x))$. В противном случае (если $n \ge m$) дробь называется **неправильной**.

**Теорема (о делении многочленов с остатком):**
Если рациональная дробь $\frac{P_n(x)}{Q_m(x)}$ является неправильной ($n \ge m$), то существует единственное представление в виде:
$\frac{P_n(x)}{Q_m(x)} = M_{n-m}(x) + \frac{N_k(x)}{Q_m(x)}$
где $M_{n-m}(x)$ - многочлен (целая часть), а $\frac{N_k(x)}{Q_m(x)}$ - правильная рациональная дробь ($k = \deg(N_k(x)) < m$).

**Определение:** Число $x_0$ называется **корнем многочлена** $Q_m(x)$, если $Q_m(x_0) = 0$.

**Теорема Безу:** Число $x_0$ является корнем многочлена $Q_m(x)$ тогда и только тогда, когда $Q_m(x)$ делится на $(x-x_0)$ без остатка, т.е.
$Q_m(x_0) = 0 \iff Q_m(x) = (x-x_0) Q_{m-1}(x)$, где $Q_{m-1}(x)$ - многочлен степени $m-1$.

**Теорема (о комплексных корнях многочлена с действительными коэффициентами):**
Если многочлен $Q_m(x)$ имеет действительные коэффициенты и число $x_0 = \alpha + i\beta \in \mathbb{C}$ ($\beta \neq 0$) является его корнем, то сопряженное число $\bar{x}_0 = \alpha - i\beta$ также является корнем $Q_m(x)$.
**Доказательство:**
Пусть $Q_m(x) = c_0 + c_1 x + \dots + c_m x^m$, где $c_i \in \mathbb{R}$.
Если $Q_m(x_0) = 0$, то $c_0 + c_1 x_0 + \dots + c_m x_0^m = 0$.
Возьмем комплексное сопряжение от обеих частей:
$\overline{c_0 + c_1 x_0 + \dots + c_m x_0^m} = \overline{0}$
$\overline{c_0} + \overline{c_1 x_0} + \dots + \overline{c_m x_0^m} = 0$
Так как $c_i \in \mathbb{R}$, то $\overline{c_i} = c_i$. Используя свойства сопряжения ($\overline{a+b}=\bar{a}+\bar{b}$, $\overline{ab}=\bar{a}\bar{b}$), получаем:
$c_0 + c_1 \bar{x}_0 + \dots + c_m \bar{x}_0^m = 0$.
Это означает, что $Q_m(\bar{x}_0) = 0$, т.е. $\bar{x}_0$ - корень $Q_m(x)$.

**Основная теорема алгебры:**
Всякий многочлен степени $m \ge 1$ с действительными (или комплексными) коэффициентами имеет по крайней мере один корень в поле комплексных чисел $\mathbb{C}$.

**Следствие:** Любой многочлен $Q_m(x)$ степени $m \ge 1$ с действительными коэффициентами имеет ровно $m$ корней в $\mathbb{C}$ (с учетом их кратности).

## Разложение многочлена на множители

**Рассуждение:**
1.  Пусть дан многочлен $Q_m(x)$ с действительными коэффициентами. По основной теореме алгебры, существует корень $x_1 \in \mathbb{C}$ такой, что $Q_m(x_1) = 0$.
2.  По теореме Безу, $Q_m(x) = (x-x_1) Q_{m-1}^{(1)}(x)$.
3.  Применяя теорему Безу последовательно к $Q_{m-1}^{(1)}(x)$, $Q_{m-2}^{(2)}(x)$, ..., получаем разложение на линейные множители над $\mathbb{C}$:
    $Q_m(x) = c_m (x-x_1)(x-x_2)...(x-x_m)$
    где $x_1, x_2, ..., x_m$ - все корни многочлена $Q_m(x)$ (с учетом кратности), а $c_m$ - старший коэффициент многочлена $Q_m(x)$.

4.  Если $Q_m(x)$ имеет действительные коэффициенты, то его комплексные корни $(\beta \neq 0)$ входят сопряженными парами. Пусть $x_0 = \alpha + i\beta$ - корень, тогда $\bar{x}_0 = \alpha - i\beta$ - тоже корень. В разложении над $\mathbb{R}$ пара линейных множителей $(x-x_0)(x-\bar{x}_0)$ объединяется в один квадратичный множитель с действительными коэффициентами:
    $(x-x_0)(x-\bar{x}_0) = (x - (\alpha + i\beta))(x - (\alpha - i\beta))$
    $= ((x-\alpha) - i\beta)((x-\alpha) + i\beta)$
    $= (x-\alpha)^2 - (i\beta)^2 = (x-\alpha)^2 + \beta^2$
    $= x^2 - 2\alpha x + \alpha^2 + \beta^2$
    Обозначим $p = -2\alpha$ и $q = \alpha^2 + \beta^2$. Тогда множитель имеет вид $x^2 + px + q$.
    Дискриминант этого квадратного трехчлена: $D = p^2 - 4q = (-2\alpha)^2 - 4(\alpha^2 + \beta^2) = 4\alpha^2 - 4\alpha^2 - 4\beta^2 = -4\beta^2$.
    Так как $\beta \neq 0$, то $D = -4\beta^2 < 0$. Это означает, что квадратный трехчлен $x^2+px+q$ не имеет действительных корней и является неприводимым над полем $\mathbb{R}$.

5.  Таким образом, любой многочлен $Q_m(x)$ с действительными коэффициентами может быть разложен над $\mathbb{R}$ в произведение своего старшего коэффициента $c_m$, линейных множителей вида $(x-x_k)$, соответствующих действительным корням $x_k$, и квадратичных множителей вида $(x^2+p_j x+q_j)$ с отрицательным дискриминантом, соответствующих парам комплексно-сопряженных корней.
    $Q_m(x) = c_m (x-x_{r_1})^{k_1} \dots (x-x_{r_s})^{k_s} (x^2+p_1 x+q_1)^{l_1} \dots (x^2+p_t x+q_t)^{l_t}$
    где $\sum k_i + 2 \sum l_j = m$.

### Теорема о разложении многочлена над $\mathbb{R}$

**Теорема:** Любой многочлен $Q_m(x)$ степени $m \ge 1$ с действительными коэффициентами может быть представлен в виде произведения своего старшего коэффициента $c_m$ и множителей вида $(x-x_i)$ и $(x^2+p_j x+q_j)$, где $x_i$ - действительные корни, а $x^2+p_j x+q_j$ - неприводимые над $\mathbb{R}$ квадратные трехчлены ($p_j^2 - 4q_j < 0$), соответствующие парам комплексно-сопряженных корней.
Будем считать $c_m=1$ (если нет, можно вынести за скобки).
$Q_m(x) = (x-x_1)^{k_1} (x-x_2)^{k_2} \dots (x-x_p)^{k_p} (x^2+p_1x+q_1)^{l_1} (x^2+p_2x+q_2)^{l_2} \dots (x^2+p_s x+q_s)^{l_s}$
где:
*   $x_i \in \mathbb{R}$ - различные действительные корни
*   $k_i \in \mathbb{N}$ - кратности действительных корней
*   $p_j, q_j \in \mathbb{R}$, $p_j^2 - 4q_j < 0$ (квадратные трехчлены неприводимы)
*   $l_j \in \mathbb{N}$ - кратности пар комплексно-сопряженных корней
*   Сумма кратностей: $\sum_{i=1}^{p} k_i + 2 \sum_{j=1}^{s} l_j = m = \deg(Q_m(x))$.

## Разложение правильной рациональной дроби на простейшие дроби

**Лемма 1:**
Пусть $\frac{P_n(x)}{Q_m(x)}$ - правильная рациональная дробь ($n < m$).
Пусть $a \in \mathbb{R}$ является корнем знаменателя $Q_m(x)$ кратности $k \ge 1$, т.е. $Q_m(a)=0$, и $Q_m(x) = (x-a)^k Q_{m-k}^{(1)}(x)$, где $Q_{m-k}^{(1)}(a) \neq 0$.
Тогда существует единственное представление:
$\frac{P_n(x)}{Q_m(x)} = \frac{A_k}{(x-a)^k} + \frac{\tilde{P}_1(x)}{(x-a)^{k-1} Q_{m-k}^{(1)}(x)}$
где $A_k \in \mathbb{R}$ - константа, а $\frac{\tilde{P}_1(x)}{(x-a)^{k-1} Q_{m-k}^{(1)}(x)}$ - также правильная рациональная дробь.

**Нахождение коэффициента $A_k$:**
Умножим обе части равенства на $(x-a)^k$:
$\frac{P_n(x)}{Q_{m-k}^{(1)}(x)} = A_k + \frac{\tilde{P}_1(x) (x-a)}{Q_{m-k}^{(1)}(x)}$
Положим $x=a$. Так как $Q_{m-k}^{(1)}(a) \neq 0$, получим:
$\frac{P_n(a)}{Q_{m-k}^{(1)}(a)} = A_k + 0$
**(!) Формула для $A_k$:** $A_k = \frac{P_n(a)}{Q_{m-k}^{(1)}(a)}$

**Доказательство существования и единственности (кратко):**
Из $\frac{P_n(x)}{Q_m(x)} - \frac{A_k}{(x-a)^k} = \frac{P_n(x) - A_k Q_{m-k}^{(1)}(x)}{(x-a)^k Q_{m-k}^{(1)}(x)}$
Выберем $A_k = \frac{P_n(a)}{Q_{m-k}^{(1)}(a)}$. Тогда числитель $R(x) = P_n(x) - A_k Q_{m-k}^{(1)}(x)$ имеет корень при $x=a$, так как $R(a) = P_n(a) - \frac{P_n(a)}{Q_{m-k}^{(1)}(a)} Q_{m-k}^{(1)}(a) = 0$.
Следовательно, $R(x) = (x-a) \tilde{P}_1(x)$ по теореме Безу.
Тогда:
$\frac{(x-a) \tilde{P}_1(x)}{(x-a)^k Q_{m-k}^{(1)}(x)} = \frac{\tilde{P}_1(x)}{(x-a)^{k-1} Q_{m-k}^{(1)}(x)}$
Можно показать, что полученная дробь является правильной.
Единственность $A_k$ доказывается от противного: предположим два разложения с $A_{k,1}$ и $A_{k,2}$, приведем к общему знаменателю и подставим $x=a$, что даст $A_{k,1} = A_{k,2}$.
*   Равенство $A_1 Q^{(1)}(x) + \tilde{P}_1(x)(x-a) = A_2 Q^{(1)}(x) + \tilde{P}_2(x)(x-a)$ при $x=a$ дает $A_1 Q^{(1)}(a) = A_2 Q^{(1)}(a)$, откуда $A_1=A_2$, так как $Q^{(1)}(a) \neq 0$.

**Следствие (Применение Леммы 1 k-раз):**
Повторяя эту процедуру $k$ раз для корня $a$, мы выделим все слагаемые, соответствующие этому корню:
$\frac{P_n(x)}{Q_m(x)} = \frac{A_k}{(x-a)^k} + \frac{A_{k-1}}{(x-a)^{k-1}} + \dots + \frac{A_1}{x-a} + \frac{\hat{P}(x)}{Q_{m-k}^{(1)}(x)}$
где $A_i \in \mathbb{R}$, а $\frac{\hat{P}(x)}{Q_{m-k}^{(1)}(x)}$ - правильная рациональная дробь, знаменатель которой уже не имеет корня $a$ ($Q_{m-k}^{(1)}(a) \neq 0$).

**Лемма 2:**
Пусть $\frac{P_n(x)}{Q_m(x)}$ - правильная рациональная дробь ($n < m$).
Пусть $(x^2+px+q)$ - неприводимый над $\mathbb{R}$ множитель ($p^2-4q < 0$) знаменателя $Q_m(x)$ кратности $k \ge 1$. То есть $Q_m(x) = (x^2+px+q)^k \tilde{Q}_{m-2k}(x)$, где $\tilde{Q}_{m-2k}(x_0) \neq 0$ для корней $x_0 = \alpha \pm i\beta$ уравнения $x^2+px+q=0$.
Тогда существует единственное представление:
$\frac{P_n(x)}{Q_m(x)} = \frac{A_k x + B_k}{(x^2+px+q)^k} + \frac{\tilde{P}_1(x)}{(x^2+px+q)^{k-1} \tilde{Q}_{m-2k}(x)}$ (**\*\***)
где $A_k, B_k \in \mathbb{R}$ - константы, а вторая дробь - правильная рациональная дробь.

**Нахождение коэффициентов $A_k, B_k$:**
Умножим обе части равенства на $(x^2+px+q)^k$:
$\frac{P_n(x)}{\tilde{Q}_{m-2k}(x)} = A_k x + B_k + \frac{\tilde{P}_1(x) (x^2+px+q)}{\tilde{Q}_{m-2k}(x)}$
Пусть $x_0 = \alpha+i\beta$ - один из комплексных корней уравнения $x^2+px+q=0$. Подставим $x=x_0$:
$\frac{P_n(x_0)}{\tilde{Q}_{m-2k}(x_0)} = A_k x_0 + B_k + 0$
Обозначим комплексное число $R = \frac{P_n(x_0)}{\tilde{Q}_{m-2k}(x_0)} = \text{Re}(R) + i \text{Im}(R)$.
$A_k (\alpha+i\beta) + B_k = \text{Re}(R) + i \text{Im}(R)$
$(A_k \alpha + B_k) + i (A_k \beta) = \text{Re}(R) + i \text{Im}(R)$
Приравнивая действительные и мнимые части, получаем систему для $A_k, B_k$:
$\begin{cases} A_k \alpha + B_k = \text{Re}(R) \\ A_k \beta = \text{Im}(R) \end{cases}$
Так как $\beta \neq 0$, система имеет единственное решение:
$A_k = \frac{\text{Im}(R)}{\beta}$
$B_k = \text{Re}(R) - A_k \alpha = \text{Re}(R) - \alpha \frac{\text{Im}(R)}{\beta}$
Так как $P_n, \tilde{Q}_{m-2k}$ имеют действительные коэффициенты, и если $x_0$ - корень, то $\bar{x}_0$ - тоже, можно показать, что $A_k, B_k$ всегда получаются действительными числами.

**Доказательство существования и единственности (кратко):**
Аналогично случаю действительного корня.
Рассмотрим разность $P_n(x) - (A_k x + B_k) \tilde{Q}_{m-2k}(x)$. Подстановка $x=x_0$ дает $P_n(x_0) - (A_k x_0 + B_k) \tilde{Q}_{m-2k}(x_0) = P_n(x_0) - \frac{P_n(x_0)}{\tilde{Q}_{m-2k}(x_0)} \tilde{Q}_{m-2k}(x_0) = 0$.
Значит $x_0$ - корень этого полинома. Так как полином имеет действительные коэффициенты, то $\bar{x}_0$ тоже корень. Следовательно, полином делится на $(x-x_0)(x-\bar{x}_0) = x^2+px+q$.
$P_n(x) - (A_k x + B_k) \tilde{Q}_{m-2k}(x) = (x^2+px+q) \hat{P}(x)$.
Это позволяет переписать исходную дробь в виде (**\*\***). Можно показать, что остаточная дробь правильная.
Единственность доказывается аналогично случаю действительных корней, приравнивая два разложения и подставляя $x=x_0$.
*   Равенство $(A_1x+B_1)\tilde{Q}(x) + \tilde{P}_1(x)(x^2+px+q) = (A_2x+B_2)\tilde{Q}(x) + \tilde{P}_2(x)(x^2+px+q)$ при $x=x_0$ дает $(A_1x_0+B_1)\tilde{Q}(x_0) = (A_2x_0+B_2)\tilde{Q}(x_0)$. Так как $\tilde{Q}(x_0) \neq 0$, имеем $A_1x_0+B_1=A_2x_0+B_2$. Приравнивая действительные и мнимые части, получаем $A_1=A_2$ и $B_1=B_2$.

**Следствие (Применение Леммы 2 k-раз):**
Повторяя эту процедуру $k$ раз для множителя $(x^2+px+q)$, мы выделим все слагаемые, соответствующие этой паре корней:
$\frac{P_n(x)}{Q_m(x)} = \frac{A_k x + B_k}{(x^2+px+q)^k} + \frac{A_{k-1} x + B_{k-1}}{(x^2+px+q)^{k-1}} + \dots + \frac{A_1 x + B_1}{x^2+px+q} + \frac{\hat{P}(x)}{\tilde{Q}_{m-2k}(x)}$
где $A_i, B_i \in \mathbb{R}$, а $\frac{\hat{P}(x)}{\tilde{Q}_{m-2k}(x)}$ - правильная рациональная дробь, знаменатель которой уже не имеет корней $x_0, \bar{x}_0$.

### Общая теорема о разложении на простейшие дроби

**Теорема:** Любую правильную рациональную дробь $\frac{P_n(x)}{Q_m(x)}$, знаменатель которой разложен на множители над $\mathbb{R}$ вида
$Q_m(x) = c_m (x-x_1)^{k_1} \dots (x-x_p)^{k_p} (x^2+p_1x+q_1)^{l_1} \dots (x^2+p_s x+q_s)^{l_s}$
можно единственным образом представить в виде суммы простейших дробей:
$$
\frac{P_n(x)}{Q_m(x)} = \sum_{i=1}^{p} \left( \frac{A_{i,k_i}}{(x-x_i)^{k_i}} + \frac{A_{i,k_i-1}}{(x-x_i)^{k_i-1}} + \dots + \frac{A_{i,1}}{x-x_i} \right) \\
+ \sum_{j=1}^{s} \left( \frac{B_{j,l_j} x + C_{j,l_j}}{(x^2+p_j x+q_j)^{l_j}} + \frac{B_{j,l_j-1} x + C_{j,l_j-1}}{(x^2+p_j x+q_j)^{l_j-1}} + \dots + \frac{B_{j,1} x + C_{j,1}}{x^2+p_j x+q_j} \right)
$$
где $A_{i,r}, B_{j,t}, C_{j,t}$ - действительные коэффициенты.
*(Примечание: В конспекте коэффициенты для квадратичных множителей обозначались $A_j x + B_j$, здесь использовано $B_j x + C_j$ для избежания конфликта с $A_{i,r}$ для линейных множителей, что является стандартной практикой).*

Интегрирование рациональной функции сводится к интегрированию многочлена (если дробь неправильная) и суммы простейших дробей.

### Tеорема о разложении правильной рациональной дроби

**Теорема:** Пусть $\frac{P_n(x)}{Q_m(x)}$ - правильная рациональная дробь ($n < m$), и знаменатель $Q_m(x)$ (со старшим коэффициентом, равным 1) разложен на множители над $\mathbb{R}$:
$Q_m(x) = (x-x_1)^{k_1} (x-x_2)^{k_2} \dots (x-x_p)^{k_p} (x^2+p_1x+q_1)^{l_1} (x^2+p_2x+q_2)^{l_2} \dots (x^2+p_s x+q_s)^{l_s}$
где $x_i \in \mathbb{R}$, $k_i \in \mathbb{N}$, $p_j, q_j \in \mathbb{R}$, $p_j^2 - 4q_j < 0$, $l_j \in \mathbb{N}$.
Тогда существует **единственное** разложение дроби $\frac{P_n(x)}{Q_m(x)}$ в сумму простейших дробей вида:
$$
\frac{P_n(x)}{Q_m(x)} = \sum_{i=1}^{p} \sum_{r=1}^{k_i} \frac{A_{i,r}}{(x-x_i)^r} + \sum_{j=1}^{s} \sum_{t=1}^{l_j} \frac{B_{j,t} x + C_{j,t}}{(x^2+p_j x+q_j)^t}
$$
где $A_{i,r}, B_{j,t}, C_{j,t} \in \mathbb{R}$ - некоторые константы.

*(Примечание: В оригинальном конспекте использовалась несколько иная индексация сумм: $\sum_{i=1}^{p} \sum_{j=1}^{k_i} \frac{A_{i,j}}{(x-x_i)^{k_i-j+1}} + \sum_{i=1}^{s} \sum_{j=1}^{l_i} \frac{B_{i,j}x+C_{i,j}}{(x^2+p_i x+q_i)^{l_i-j+1}}$. Представленная выше форма является стандартной и эквивалентной.)*

**Замечание:** Если исходная дробь $\frac{P_n(x)}{Q_m(x)}$ неправильная ($n \ge m$), то сначала необходимо выделить целую часть (многочлен) с помощью деления "уголком":
$\frac{P_n(x)}{Q_m(x)} = M_{n-m}(x) + \frac{N_k(x)}{Q_m(x)}$, где $k < m$.
Затем правильную дробь $\frac{N_k(x)}{Q_m(x)}$ раскладывают на простейшие.

### Интегрирование простейших дробей

**Определение:** Простейшими дробями I, II, III, IV типов называются соответственно дроби вида:
I. $\frac{A}{x-a}$
II. $\frac{A}{(x-a)^k}$, где $k \in \mathbb{N}, k \ge 2$.
III. $\frac{Ax+B}{x^2+px+q}$, где $p^2-4q < 0$.
IV. $\frac{Ax+B}{(x^2+px+q)^k}$, где $p^2-4q < 0$, $k \in \mathbb{N}, k \ge 2$.

Интегралы от простейших дробей:

I. $\int \frac{A}{x-a} dx = A \int \frac{d(x-a)}{x-a} = A \ln|x-a| + C$

II. $\int \frac{A}{(x-a)^k} dx = A \int (x-a)^{-k} d(x-a) = A \frac{(x-a)^{-k+1}}{-k+1} + C = \frac{A}{(1-k)(x-a)^{k-1}} + C$

III. $\int \frac{Ax+B}{x^2+px+q} dx$
   Знаменатель $x^2+px+q$ имеет комплексные корни, т.к. $D=p^2-4q<0$.
   Выделим в числителе производную знаменателя $(x^2+px+q)' = 2x+p$:
   $Ax+B = \frac{A}{2}(2x+p) - \frac{Ap}{2} + B = \frac{A}{2}(2x+p) + \left(B - \frac{Ap}{2}\right)$
   Тогда интеграл разбивается на два:
   $\int \frac{\frac{A}{2}(2x+p)}{x^2+px+q} dx + \int \frac{B - \frac{Ap}{2}}{x^2+px+q} dx$
   Первый интеграл: $\frac{A}{2} \int \frac{d(x^2+px+q)}{x^2+px+q} = \frac{A}{2} \ln(x^2+px+q) + C_1$ (модуль не нужен, т.к. $x^2+px+q > 0$ при $D<0$).
   Второй интеграл: Выделим полный квадрат в знаменателе:
   $x^2+px+q = \left(x + \frac{p}{2}\right)^2 + q - \frac{p^2}{4} = \left(x + \frac{p}{2}\right)^2 + a^2$, где $a^2 = q - \frac{p^2}{4} > 0$.
   $\left(B - \frac{Ap}{2}\right) \int \frac{dx}{(x+p/2)^2 + a^2} = \left(B - \frac{Ap}{2}\right) \frac{1}{a} \arctan\left(\frac{x+p/2}{a}\right) + C_2$
   Объединяя:
   $\int \frac{Ax+B}{x^2+px+q} dx = \frac{A}{2} \ln(x^2+px+q) + \frac{B - Ap/2}{\sqrt{q-p^2/4}} \arctan\left(\frac{x+p/2}{\sqrt{q-p^2/4}}\right) + C$

IV. $\int \frac{Ax+B}{(x^2+px+q)^k} dx$, где $k \ge 2$.
   Аналогично типу III, выделяем производную знаменателя в числителе:
   $\int \frac{\frac{A}{2}(2x+p)}{(x^2+px+q)^k} dx + \int \frac{B - \frac{Ap}{2}}{(x^2+px+q)^k} dx$
   Первый интеграл:
   $\frac{A}{2} \int (x^2+px+q)^{-k} d(x^2+px+q) = \frac{A}{2} \frac{(x^2+px+q)^{-k+1}}{-k+1} + C_1 = \frac{A}{2(1-k)(x^2+px+q)^{k-1}} + C_1$.
   Второй интеграл: $\left(B - \frac{Ap}{2}\right) \int \frac{dx}{((x+p/2)^2 + a^2)^k} = \left(B - \frac{Ap}{2}\right) \int \frac{dt}{(t^2+a^2)^k}$, где $t=x+p/2$, $a^2=q-p^2/4$.
   Обозначим $I_k = \int \frac{dt}{(t^2+a^2)^k}$. Этот интеграл вычисляется с помощью рекуррентной формулы.

   **Вывод рекуррентной формулы для $I_k = \int \frac{dt}{(t^2+a^2)^k}$:**
   $I_k = \int \frac{dt}{(t^2+a^2)^k} = \frac{1}{a^2} \int \frac{a^2+t^2-t^2}{(t^2+a^2)^k} dt$
   $I_k = \frac{1}{a^2} \left( \int \frac{t^2+a^2}{(t^2+a^2)^k} dt - \int \frac{t^2}{(t^2+a^2)^k} dt \right)$
   $I_k = \frac{1}{a^2} \left( I_{k-1} - \int t \cdot \frac{t}{(t^2+a^2)^k} dt \right)$
   Интегрируем по частям $\int t \cdot \frac{t dt}{(t^2+a^2)^k}$:
   $u=t \implies du=dt$
   $dv = \frac{t dt}{(t^2+a^2)^k} \implies v = \int \frac{t dt}{(t^2+a^2)^k} = \frac{1}{2} \int \frac{d(t^2+a^2)}{(t^2+a^2)^k} = \frac{1}{2(1-k)(t^2+a^2)^{k-1}}$
   $\int t dv = uv - \int v du = \frac{t}{2(1-k)(t^2+a^2)^{k-1}} - \int \frac{dt}{2(1-k)(t^2+a^2)^{k-1}}$
   $\int t \frac{t dt}{(t^2+a^2)^k} = \frac{t}{2(1-k)(t^2+a^2)^{k-1}} - \frac{1}{2(1-k)} I_{k-1}$
   Подставляем обратно в выражение для $I_k$:
   $I_k = \frac{1}{a^2} \left( I_{k-1} - \left[ \frac{t}{2(1-k)(t^2+a^2)^{k-1}} - \frac{1}{2(1-k)} I_{k-1} \right] \right)$
   $I_k = \frac{1}{a^2} \left( I_{k-1} \left(1 + \frac{1}{2(k-1)}\right) + \frac{t}{2(k-1)(t^2+a^2)^{k-1}} \right)$
   $I_k = \frac{1}{a^2} \left( I_{k-1} \frac{2k-2+1}{2(k-1)} + \frac{t}{2(k-1)(t^2+a^2)^{k-1}} \right)$
   $$ I_k = \frac{2k-3}{2a^2(k-1)} I_{k-1} + \frac{1}{2a^2(k-1)} \frac{t}{(t^2+a^2)^{k-1}} $$
   Эта формула позволяет свести вычисление $I_k$ к $I_{k-1}$, затем к $I_{k-2}$, и так далее, пока не дойдем до $I_1 = \int \frac{dt}{t^2+a^2} = \frac{1}{a} \arctan(\frac{t}{a}) + C$.

**Вывод:** Интеграл от любой рациональной функции $\int \frac{P_n(x)}{Q_m(x)} dx$ всегда выражается через элементарные функции (многочлены, логарифмы, арктангенсы).